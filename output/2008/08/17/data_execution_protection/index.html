<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>yob.id.au: Data Execution Protection</title>
    <link rel="alternate" type="application/atom+xml" title="Atom" href="/atom/index.xml" />
    <style type="text/css" media="screen">
      * {
        margin: 0;
        padding: 0;
      
        font-family: Georgia, Palatino, Times, 'Times New Roman', sans-serif;
      }
      
      body {
        background: #fff;
      }
      
      a {
        text-decoration: none;
      }
      
      a:link,
      a:visited {
        color: #f30;
      }
      
      a:hover {
        color: #f90;
      }
      
      #main {
        position: absolute;
      
        top: 20px;
        left: 280px;
      
        width: 500px;
      }
      
      #main h1 {
        font-size: 40px;
        font-weight: normal;
      
        line-height: 40px;
      
        padding: 20px 0 20px 0;
      
        letter-spacing: -1px;
      }
      
      #main p {
        margin: 0 0 20px 0;
        
        font-size: 15px;
        
        line-height: 20px;
      }
      
      #main ul {
        padding: 0 0 0 20px;
      }
      
      #main li {
        margin: 0 0 20px 0;
      
        list-style-type: square;
      
        font-size: 15px;
        
        line-height: 20px;
      }
      
      #sidebar {
        position: absolute;
      
        top: 40px;
        left: 20px;
        width: 200px;
      
        padding: 20px 20px 0 0;
      
        border-right: 1px solid #ccc;
      
        text-align: right;
      }
      
      #sidebar h2 {
        text-transform: uppercase;
      
        font-size: 13px;
      
        color: #333;
      
        letter-spacing: 1px;
      
        line-height: 20px;
      }
      
      #sidebar ul {
        list-style-type: none;
      
        margin: 20px 0;
      }
      
      #sidebar li {
        font-size: 14px;
      
        line-height: 20px;
      }
    </style>
  </head>
  <body>
    <div id="main">
      <h1>Data Execution Protection</h1>
<p>I was just bitten by a feature of recent Windows OS's that I hadn't encountered
before: <a href="http://en.wikipedia.org/wiki/Data_Execution_Prevention">Data Execution Protection</a>.</p>

<p>It allows pages of memory to be marked as executable or non-executable, which
sounds reasonable to me, as it can prevent malicious data that ends up in a
'data' chunk of memory (via a buffer overflow attack or something) from
causing much damage.</p>

<p>DEP is enabled by default on Windows XP SP2 and above, and Windows Server 2003,
but only works at full effectiveness if the CPU supports it as well.</p>

<p>In my case, I'm replacing an old P4 based 2003 server with a Core 2 Quad based
one. An application that worked fine on the old server was refusing to load on
the new one, displaying the following cryptic error message as the only clue:</p>

<pre><code>The application failed to initialize properly (0xC0000005). Click OK to terminate the application.
</code></pre>

<p>A bit of googling turned up <a href="http://www.updatexp.com/0xC0000005.html">this
site</a> which put me on the path to a
solution.</p>

<p>It turns out some badly coded applications (like this one) require their data
chunks of memory to be executable. To exclude an application from DEP, open the
system control panel, select the advanced tab, open performance settings,
select the DEP tab, and add the bothersome application to the exclusion list.</p>

<p>I suspect in our case, the issue isn't the application itself but the mediocre
library it uses to render GUI widgets: <a href="http://www.cavo.com/">CA Visual
Objects</a></p>
    </div>
    <div id="sidebar">
      <h2>Pages</h2>
      <ul>
        <li><a href="/">home</a></li>
        <li><a href="/archive">archive</a></li>
        <li><a href="/about">about</a></li>
      </ul>
      <h2>Syndication</h2>
      <ul>
        <li><a href="/atom/index.xml">atom</a></li>
      </ul>
    </div>
  </body>
</html>
